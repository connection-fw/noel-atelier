# 環境変数の確認と設定手順

## 現在の状況

アプリで「APIキーが必要」と表示される場合、以下のいずれかが原因です：

1. 環境変数が設定されていない
2. 環境変数を設定した後、再デプロイしていない
3. 環境変数の名前が間違っている

## 確認手順

### ステップ1: 環境変数が設定されているか確認

1. **Netlifyダッシュボードを開く**
   - https://app.netlify.com/ にアクセス
   - プロジェクト「tubular-rolypoly-9d3122」を選択

2. **環境変数の設定ページを開く**
   - 左サイドバーから「**Project configuration**」をクリック
   - 左サイドバーから「**Environment variables**」を選択

3. **環境変数を確認**
   - 以下の2つの環境変数が表示されているか確認：
     - `VITE_API_TYPE`
     - `VITE_HUGGINGFACE_API_KEY`

### ステップ2: 環境変数が設定されていない場合

以下の手順で環境変数を設定してください：

#### 1つ目の環境変数を追加

1. 「**Add a variable**」ボタンをクリック
2. 「**Add a single variable**」を選択
3. 以下の値を入力：
   - **Key**: `VITE_API_TYPE`
   - **Value**: `huggingface`
   - **Scope**: 「All scopes」のまま（変更不要）
   - **Deploy context**: 「All contexts」のまま（変更不要）
4. 「**Save**」をクリック

#### 2つ目の環境変数を追加

1. 再度「**Add a variable**」ボタンをクリック
2. 「**Add a single variable**」を選択
3. 以下の値を入力：
   - **Key**: `VITE_HUGGINGFACE_API_KEY`
   - **Value**: Hugging Faceで取得したAPIキー（`hf_` で始まる文字列）
   - **Scope**: 「All scopes」のまま（変更不要）
   - **Deploy context**: 「All contexts」のまま（変更不要）
4. 「**Save**」をクリック

### ステップ3: 再デプロイ（重要！）

環境変数を設定した後、**必ず再デプロイが必要**です。

1. **「Deploys」タブを開く**
   - 左サイドバーから「**Deploys**」をクリック

2. **再デプロイを実行**
   - 方法1: `dist`フォルダをドラッグ&ドロップ
     - ローカルで `npm run build` を実行
     - `dist`フォルダをNetlifyの「Deploys」ページにドラッグ&ドロップ
   
   - 方法2: 「Trigger deploy」ボタンを使用（表示されている場合）
     - 「Trigger deploy」→「Deploy site」をクリック

3. **デプロイ完了を待つ**
   - 数秒〜数分かかります
   - 「Published」と表示されれば成功です

### ステップ4: ブラウザのキャッシュをクリア

再デプロイ後、ブラウザのキャッシュをクリアしてください：

- **Mac**: `Command + Shift + R`
- **Windows**: `Ctrl + Shift + R`

または、シークレットモード（プライベートブラウジング）でサイトを開いて確認してください。

## よくある問題

### 問題1: 環境変数を設定したのに反映されない

**原因**: 再デプロイしていない

**解決方法**: 
- 環境変数を設定した後、必ず再デプロイしてください
- 再デプロイ後、ブラウザのキャッシュをクリアしてください

### 問題2: APIキーが正しく設定されているかわからない

**確認方法**:
1. 「Environment variables」ページで、`VITE_HUGGINGFACE_API_KEY`の値を確認
2. 目のアイコンをクリックして、値が表示されることを確認
3. 値が`hf_`で始まっていることを確認

### 問題3: 環境変数の名前が間違っている

**正しい名前**:
- `VITE_API_TYPE`（大文字小文字を正確に）
- `VITE_HUGGINGFACE_API_KEY`（大文字小文字を正確に）

**確認方法**:
- 環境変数のリストで、名前が正確に一致しているか確認

## 確認チェックリスト

- [ ] `VITE_API_TYPE` が設定されている
- [ ] `VITE_HUGGINGFACE_API_KEY` が設定されている
- [ ] APIキーの値が `hf_` で始まっている
- [ ] 環境変数を設定した後、再デプロイした
- [ ] 再デプロイが完了している（「Published」と表示されている）
- [ ] ブラウザのキャッシュをクリアした

すべてチェックがついていれば、サイトを再読み込みして確認してください。

